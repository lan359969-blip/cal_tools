<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>è¯å‰‚æ¶ˆè€—æ ¸ç®—</title>
<link href="//unpkg.com/layui@2.9.13/dist/css/layui.css" rel="stylesheet">
<style>
body{padding:10px}
table{width:100%;border-collapse:collapse}
td,th{border:1px solid #ccc;padding:4px;text-align:center}
input{
    width:100%;
    box-sizing:border-box;
    font-size:16px;
    height:36px;
    padding:4px 6px;
}
textarea{
    width:100%;
    box-sizing:border-box;
    min-height:160px;
    font-size:15px;
}
.section{margin-bottom:30px}
.footer{margin-top:20px;color:#666;font-size:12px}
</style>
</head>
<body>

<div class="layui-btn-container" style="margin-bottom:15px">
    <button class="layui-btn layui-btn-primary" onclick="window.location.href='index.html'">
        â¬… è¿”å›åŠ è¯è®¡ç®—
    </button>
</div>

<h1>è¯å‰‚æ¶ˆè€—æ ¸ç®—</h1>

<p>æµ“åº¦ï¼ˆ%ï¼‰ï¼š</p>
<table>
<tr><th></th><th>æµ“åº¦</th></tr>
<tr><td>ä¸€æœŸæ··å‡</td><td><input id="c_p1_m"></td></tr>
<tr><td>ä¸€æœŸåŠ©å‡</td><td><input id="c_p1_a"></td></tr>
<tr><td>äºŒæœŸæ··å‡</td><td><input id="c_p2_m"></td></tr>
<tr><td>äºŒæœŸåŠ©å‡</td><td><input id="c_p2_a"></td></tr>
</table>

<div class="section"><h2>ä¸€æœŸ Â· æ··å‡</h2>
<table>
<tr><th>æ—¶é—´</th><th>1</th><th>2</th><th>3</th><th>4</th><th>ä¸€äºŒç³»æ¶ˆè€—</th><th>ä¸‰å››ç³»æ¶ˆè€—</th></tr>
<tr><td>8</td><td><input id="p1m18"></td><td><input id="p1m28"></td><td><input id="p1m38"></td><td><input id="p1m48"></td><td rowspan="2" id="o_p1_m_12"></td><td rowspan="2" id="o_p1_m_34"></td></tr>
<tr><td>17</td><td><input id="p1m117"></td><td><input id="p1m217"></td><td><input id="p1m317"></td><td><input id="p1m417"></td></tr>
</table></div>

<div class="section"><h2>ä¸€æœŸ Â· åŠ©å‡</h2>
<table>
<tr><th>æ—¶é—´</th><th>1</th><th>2</th><th>3</th><th>4</th><th>ä¸€äºŒç³»æ¶ˆè€—</th><th>ä¸‰å››ç³»æ¶ˆè€—</th></tr>
<tr><td>8</td><td><input id="p1a18"></td><td><input id="p1a28"></td><td><input id="p1a38"></td><td><input id="p1a48"></td><td rowspan="2" id="o_p1_a_12"></td><td rowspan="2" id="o_p1_a_34"></td></tr>
<tr><td>17</td><td><input id="p1a117"></td><td><input id="p1a217"></td><td><input id="p1a317"></td><td><input id="p1a417"></td></tr>
</table></div>

<div class="section"><h2>äºŒæœŸ Â· æ··å‡</h2>
<table>
<tr><th>æ—¶é—´</th><th>5-1</th><th>5-2</th><th>6-1</th><th>6-2</th><th>5ç³»æ¶ˆè€—</th><th>6ç³»æ¶ˆè€—</th></tr>
<tr><td>8</td><td><input id="p2m518"></td><td><input id="p2m528"></td><td><input id="p2m618"></td><td><input id="p2m628"></td><td rowspan="2" id="o_p2_m_5"></td><td rowspan="2" id="o_p2_m_6"></td></tr>
<tr><td>17</td><td><input id="p2m5117"></td><td><input id="p2m5217"></td><td><input id="p2m6117"></td><td><input id="p2m6217"></td></tr>
</table></div>

<div class="section"><h2>äºŒæœŸ Â· åŠ©å‡</h2>
<table>
<tr><th>æ—¶é—´</th><th>5-1</th><th>5-2</th><th>6-1</th><th>6-2</th><th>5ç³»æ¶ˆè€—</th><th>6ç³»æ¶ˆè€—</th></tr>
<tr><td>8</td><td><input id="p2a518"></td><td><input id="p2a528"></td><td><input id="p2a618"></td><td><input id="p2a628"></td><td rowspan="2" id="o_p2_a_5"></td><td rowspan="2" id="o_p2_a_6"></td></tr>
<tr><td>17</td><td><input id="p2a5117"></td><td><input id="p2a5217"></td><td><input id="p2a6117"></td><td><input id="p2a6217"></td></tr>
</table></div>

<h2>è‡ªåŠ¨ç”Ÿæˆç­æŠ¥ / æ—¥æŠ¥</h2>
<textarea id="report"></textarea>

<button onclick="copyReport()" style="margin-top:8px;width:100%;height:44px;font-size:16px;">
ğŸ“‹ ä¸€é”®å¤åˆ¶ç­æŠ¥
</button>

<div class="footer">è®¡ç®—ç‰ˆæœ¬ï¼šV1.1.20260110</div>

<script>
function n(id){return parseFloat(document.getElementById(id).value)||0}
function save(){document.querySelectorAll('input,textarea').forEach(e=>localStorage.setItem(e.id,e.value))}
function load(){document.querySelectorAll('input,textarea').forEach(e=>{const v=localStorage.getItem(e.id);if(v!==null)e.value=v})}

function calc(){
 const p1m12=(n('p1m117')-n('p1m18')+n('p1m217')-n('p1m28'))*n('c_p1_m')/100;
 const p1m34=(n('p1m317')-n('p1m38')+n('p1m417')-n('p1m48'))*n('c_p1_m')/100;

 const p1a12=(n('p1a117')-n('p1a18')+n('p1a217')-n('p1a28'))*n('c_p1_a')/100;
 const p1a34=(n('p1a317')-n('p1a38')+n('p1a417')-n('p1a48'))*n('c_p1_a')/100;

 const p2m5=(n('p2m5117')-n('p2m518')+n('p2m5217')-n('p2m528'))*n('c_p2_m')/100;
 const p2m6=(n('p2m6117')-n('p2m618')+n('p2m6217')-n('p2m628'))*n('c_p2_m')/100;

 const p2a5=(n('p2a5117')-n('p2a518')+n('p2a5217')-n('p2a528'))*n('c_p2_a')/100;
 const p2a6=(n('p2a6117')-n('p2a618')+n('p2a6217')-n('p2a628'))*n('c_p2_a')/100;

 document.getElementById('o_p1_m_12').innerText=p1m12.toFixed(2);
 document.getElementById('o_p1_m_34').innerText=p1m34.toFixed(2);
 document.getElementById('o_p1_a_12').innerText=p1a12.toFixed(2);
 document.getElementById('o_p1_a_34').innerText=p1a34.toFixed(2);
 document.getElementById('o_p2_m_5').innerText=p2m5.toFixed(2);
 document.getElementById('o_p2_m_6').innerText=p2m6.toFixed(2);
 document.getElementById('o_p2_a_5').innerText=p2a5.toFixed(2);
 document.getElementById('o_p2_a_6').innerText=p2a6.toFixed(2);

 document.getElementById('report').value =
`è¯å‰‚æ¶ˆè€—æ—¥æŠ¥
ä¸€æœŸæ··å‡ï¼š${p1m12.toFixed(2)} / ${p1m34.toFixed(2)}ï¼ˆåˆè®¡ï¼š${(p1m12+p1m34).toFixed(2)}ï¼‰
ä¸€æœŸåŠ©å‡ï¼š${p1a12.toFixed(2)} / ${p1a34.toFixed(2)}ï¼ˆåˆè®¡ï¼š${(p1a12+p1a34).toFixed(2)}ï¼‰
äºŒæœŸæ··å‡ï¼š${p2m5.toFixed(2)} / ${p2m6.toFixed(2)}ï¼ˆåˆè®¡ï¼š${(p2m5+p2m6).toFixed(2)}ï¼‰
äºŒæœŸåŠ©å‡ï¼š${p2a5.toFixed(2)} / ${p2a6.toFixed(2)}ï¼ˆåˆè®¡ï¼š${(p2a5+p2a6).toFixed(2)}ï¼‰
ç‰ˆæœ¬ï¼šV1.1.20260110`;

 save();
}

function copyReport(){
 const t=document.getElementById('report');
 t.select();
 document.execCommand('copy');
 alert('ç­æŠ¥å†…å®¹å·²å¤åˆ¶ï¼Œå¯ç›´æ¥ç²˜è´´');
}

document.querySelectorAll('input').forEach(e=>e.addEventListener('input',calc));
load();calc();
</script>

</body>
</html>